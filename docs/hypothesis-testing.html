<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Hypothesis testing | R cookbook for the casual dabbler</title>
  <meta name="description" content="A practical user guide for R in advisory." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Hypothesis testing | R cookbook for the casual dabbler" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A practical user guide for R in advisory." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Hypothesis testing | R cookbook for the casual dabbler" />
  
  <meta name="twitter:description" content="A practical user guide for R in advisory." />
  

<meta name="author" content="Charles Coverdale" />


<meta name="date" content="2022-06-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="charts.html"/>
<link rel="next" href="forecasting.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.23/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Cookbook for the Casual Dabbler</a></li> 

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#additional-resources"><i class="fa fa-check"></i><b>1.2</b> Additional resources</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#limitations"><i class="fa fa-check"></i><b>1.3</b> Limitations</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i><b>1.4</b> About the author</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="making-beautiful-maps-in-r.html"><a href="making-beautiful-maps-in-r.html"><i class="fa fa-check"></i><b>2</b> Making beautiful maps in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="making-beautiful-maps-in-r.html"><a href="making-beautiful-maps-in-r.html#why-use-a-map"><i class="fa fa-check"></i><b>2.1</b> Why use a map</a></li>
<li class="chapter" data-level="2.2" data-path="making-beautiful-maps-in-r.html"><a href="making-beautiful-maps-in-r.html#getting-started"><i class="fa fa-check"></i><b>2.2</b> Getting started</a></li>
<li class="chapter" data-level="2.3" data-path="making-beautiful-maps-in-r.html"><a href="making-beautiful-maps-in-r.html#making-your-first-map"><i class="fa fa-check"></i><b>2.3</b> Making your first map</a></li>
<li class="chapter" data-level="2.4" data-path="making-beautiful-maps-in-r.html"><a href="making-beautiful-maps-in-r.html#from-okay-to-good"><i class="fa fa-check"></i><b>2.4</b> From okay to good</a></li>
<li class="chapter" data-level="2.5" data-path="making-beautiful-maps-in-r.html"><a href="making-beautiful-maps-in-r.html#from-good-to-great"><i class="fa fa-check"></i><b>2.5</b> From good to great</a></li>
<li class="chapter" data-level="2.6" data-path="making-beautiful-maps-in-r.html"><a href="making-beautiful-maps-in-r.html#from-great-to-fantastic"><i class="fa fa-check"></i><b>2.6</b> From great to fantastic</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-modelling-in-r.html"><a href="basic-modelling-in-r.html"><i class="fa fa-check"></i><b>3</b> Basic modelling in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-modelling-in-r.html"><a href="basic-modelling-in-r.html#source-format-and-plot-data"><i class="fa fa-check"></i><b>3.1</b> Source, format, and plot data</a></li>
<li class="chapter" data-level="3.2" data-path="basic-modelling-in-r.html"><a href="basic-modelling-in-r.html#build-a-linear-model"><i class="fa fa-check"></i><b>3.2</b> Build a linear model</a></li>
<li class="chapter" data-level="3.3" data-path="basic-modelling-in-r.html"><a href="basic-modelling-in-r.html#analyse-the-model-fit"><i class="fa fa-check"></i><b>3.3</b> Analyse the model fit</a></li>
<li class="chapter" data-level="3.4" data-path="basic-modelling-in-r.html"><a href="basic-modelling-in-r.html#compare-the-predicted-values-with-the-actual-values"><i class="fa fa-check"></i><b>3.4</b> Compare the predicted values with the actual values</a></li>
<li class="chapter" data-level="3.5" data-path="basic-modelling-in-r.html"><a href="basic-modelling-in-r.html#analyse-the-residuals"><i class="fa fa-check"></i><b>3.5</b> Analyse the residuals</a></li>
<li class="chapter" data-level="3.6" data-path="basic-modelling-in-r.html"><a href="basic-modelling-in-r.html#linear-regression-with-more-than-one-variable"><i class="fa fa-check"></i><b>3.6</b> Linear regression with more than one variable</a></li>
<li class="chapter" data-level="3.7" data-path="basic-modelling-in-r.html"><a href="basic-modelling-in-r.html#fitting-a-polynomial-regression"><i class="fa fa-check"></i><b>3.7</b> Fitting a polynomial regression</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html"><i class="fa fa-check"></i><b>4</b> Working with raster data in R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#getting-started-1"><i class="fa fa-check"></i><b>4.1</b> Getting started</a></li>
<li class="chapter" data-level="4.2" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#import-data"><i class="fa fa-check"></i><b>4.2</b> Import data</a></li>
<li class="chapter" data-level="4.3" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#data-wrangling"><i class="fa fa-check"></i><b>4.3</b> Data Wrangling</a></li>
<li class="chapter" data-level="4.4" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#working-with-raster-data"><i class="fa fa-check"></i><b>4.4</b> Working with raster data</a></li>
<li class="chapter" data-level="4.5" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#making-an-interactive-map"><i class="fa fa-check"></i><b>4.5</b> Making an interactive map</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="election-data-in-r.html"><a href="election-data-in-r.html"><i class="fa fa-check"></i><b>5</b> Election data in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="election-data-in-r.html"><a href="election-data-in-r.html#getting-started-2"><i class="fa fa-check"></i><b>5.1</b> Getting started</a></li>
<li class="chapter" data-level="5.2" data-path="election-data-in-r.html"><a href="election-data-in-r.html#working-with-election-maps"><i class="fa fa-check"></i><b>5.2</b> Working with election maps</a></li>
<li class="chapter" data-level="5.3" data-path="election-data-in-r.html"><a href="election-data-in-r.html#answering-election-questions"><i class="fa fa-check"></i><b>5.3</b> Answering election questions</a></li>
<li class="chapter" data-level="5.4" data-path="election-data-in-r.html"><a href="election-data-in-r.html#demographic-analysis-of-voting-trends"><i class="fa fa-check"></i><b>5.4</b> Demographic analysis of voting trends</a></li>
<li class="chapter" data-level="5.5" data-path="election-data-in-r.html"><a href="election-data-in-r.html#mapping-booths"><i class="fa fa-check"></i><b>5.5</b> Mapping booths</a></li>
<li class="chapter" data-level="5.6" data-path="election-data-in-r.html"><a href="election-data-in-r.html#exploring-booth-level-data"><i class="fa fa-check"></i><b>5.6</b> Exploring booth level data</a></li>
<li class="chapter" data-level="5.7" data-path="election-data-in-r.html"><a href="election-data-in-r.html#donkeys-dicks-and-other-informalities"><i class="fa fa-check"></i><b>5.7</b> Donkeys, dicks, and other informalities</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>6</b> Charts</a>
<ul>
<li class="chapter" data-level="6.1" data-path="charts.html"><a href="charts.html#getting-started-3"><i class="fa fa-check"></i><b>6.1</b> Getting started</a></li>
<li class="chapter" data-level="6.2" data-path="charts.html"><a href="charts.html#make-the-data-tidy"><i class="fa fa-check"></i><b>6.2</b> Make the data tidy</a></li>
<li class="chapter" data-level="6.3" data-path="charts.html"><a href="charts.html#line-plot"><i class="fa fa-check"></i><b>6.3</b> Line plot</a></li>
<li class="chapter" data-level="6.4" data-path="charts.html"><a href="charts.html#scatter-and-trend-plot"><i class="fa fa-check"></i><b>6.4</b> Scatter and trend plot</a></li>
<li class="chapter" data-level="6.5" data-path="charts.html"><a href="charts.html#shading-areas-on-plots"><i class="fa fa-check"></i><b>6.5</b> Shading areas on plots</a></li>
<li class="chapter" data-level="6.6" data-path="charts.html"><a href="charts.html#bar-chart-numercial"><i class="fa fa-check"></i><b>6.6</b> Bar chart (numercial)</a></li>
<li class="chapter" data-level="6.7" data-path="charts.html"><a href="charts.html#stacked-bar-chart"><i class="fa fa-check"></i><b>6.7</b> Stacked bar chart</a></li>
<li class="chapter" data-level="6.8" data-path="charts.html"><a href="charts.html#histogram"><i class="fa fa-check"></i><b>6.8</b> Histogram</a></li>
<li class="chapter" data-level="6.9" data-path="charts.html"><a href="charts.html#ridge-chart"><i class="fa fa-check"></i><b>6.9</b> Ridge chart</a></li>
<li class="chapter" data-level="6.10" data-path="charts.html"><a href="charts.html#bbc-style-bar-charts-categorical"><i class="fa fa-check"></i><b>6.10</b> BBC style: Bar charts (categorical)</a></li>
<li class="chapter" data-level="6.11" data-path="charts.html"><a href="charts.html#bbc-style-dumbbell-charts"><i class="fa fa-check"></i><b>6.11</b> BBC style: Dumbbell charts</a></li>
<li class="chapter" data-level="6.12" data-path="charts.html"><a href="charts.html#facet-wraps"><i class="fa fa-check"></i><b>6.12</b> Facet wraps</a></li>
<li class="chapter" data-level="6.13" data-path="charts.html"><a href="charts.html#pie-chart"><i class="fa fa-check"></i><b>6.13</b> Pie chart</a></li>
<li class="chapter" data-level="6.14" data-path="charts.html"><a href="charts.html#patchwork"><i class="fa fa-check"></i><b>6.14</b> Patchwork</a></li>
<li class="chapter" data-level="6.15" data-path="charts.html"><a href="charts.html#saving-to-powerpoint"><i class="fa fa-check"></i><b>6.15</b> Saving to powerpoint</a></li>
<li class="chapter" data-level="6.16" data-path="charts.html"><a href="charts.html#automating-chart-creation"><i class="fa fa-check"></i><b>6.16</b> Automating chart creation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>7</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-quick-refresher"><i class="fa fa-check"></i><b>7.1</b> A quick refresher</a></li>
<li class="chapter" data-level="7.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#t-testing-our-first-hypothesis"><i class="fa fa-check"></i><b>7.2</b> T-testing our first hypothesis</a></li>
<li class="chapter" data-level="7.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#tailed-tests"><i class="fa fa-check"></i><b>7.3</b> Tailed tests</a></li>
<li class="chapter" data-level="7.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#correlation-and-working-with-normal-distributions"><i class="fa fa-check"></i><b>7.4</b> Correlation (and working with normal distributions)</a></li>
<li class="chapter" data-level="7.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-mean"><i class="fa fa-check"></i><b>7.5</b> Confidence intervals (mean)</a></li>
<li class="chapter" data-level="7.6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-model"><i class="fa fa-check"></i><b>7.6</b> Confidence intervals (model)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>8</b> Forecasting</a>
<ul>
<li class="chapter" data-level="8.1" data-path="forecasting.html"><a href="forecasting.html#background"><i class="fa fa-check"></i><b>8.1</b> Background</a></li>
<li class="chapter" data-level="8.2" data-path="forecasting.html"><a href="forecasting.html#arima-models"><i class="fa fa-check"></i><b>8.2</b> ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="web-scraping.html"><a href="web-scraping.html"><i class="fa fa-check"></i><b>9</b> Web-scraping</a>
<ul>
<li class="chapter" data-level="9.1" data-path="web-scraping.html"><a href="web-scraping.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="web-scraping.html"><a href="web-scraping.html#anatomy-of-a-webpage"><i class="fa fa-check"></i><b>9.2</b> Anatomy of a webpage</a></li>
<li class="chapter" data-level="9.3" data-path="web-scraping.html"><a href="web-scraping.html#scraping-a-table"><i class="fa fa-check"></i><b>9.3</b> Scraping a table</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="text-mining.html"><a href="text-mining.html"><i class="fa fa-check"></i><b>10</b> Text-mining</a>
<ul>
<li class="chapter" data-level="10.1" data-path="text-mining.html"><a href="text-mining.html#power-with-words"><i class="fa fa-check"></i><b>10.1</b> Power with words</a></li>
<li class="chapter" data-level="10.2" data-path="text-mining.html"><a href="text-mining.html#frequency-analysis"><i class="fa fa-check"></i><b>10.2</b> Frequency analysis</a></li>
<li class="chapter" data-level="10.3" data-path="text-mining.html"><a href="text-mining.html#sentiment-analysis"><i class="fa fa-check"></i><b>10.3</b> Sentiment analysis</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="economic-indicators.html"><a href="economic-indicators.html"><i class="fa fa-check"></i><b>11</b> Economic indicators</a>
<ul>
<li class="chapter" data-level="11.1" data-path="economic-indicators.html"><a href="economic-indicators.html#overview"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="economic-indicators.html"><a href="economic-indicators.html#gross-domestic-product"><i class="fa fa-check"></i><b>11.2</b> Gross Domestic Product</a></li>
<li class="chapter" data-level="11.3" data-path="economic-indicators.html"><a href="economic-indicators.html#unemployment-rate"><i class="fa fa-check"></i><b>11.3</b> Unemployment rate</a></li>
<li class="chapter" data-level="11.4" data-path="economic-indicators.html"><a href="economic-indicators.html#inflation-cpi"><i class="fa fa-check"></i><b>11.4</b> Inflation (CPI)</a></li>
<li class="chapter" data-level="11.5" data-path="economic-indicators.html"><a href="economic-indicators.html#wage-price-index"><i class="fa fa-check"></i><b>11.5</b> Wage Price Index</a></li>
<li class="chapter" data-level="11.6" data-path="economic-indicators.html"><a href="economic-indicators.html#rba-cash-rate"><i class="fa fa-check"></i><b>11.6</b> RBA cash rate</a></li>
<li class="chapter" data-level="11.7" data-path="economic-indicators.html"><a href="economic-indicators.html#aud-exchange-rate"><i class="fa fa-check"></i><b>11.7</b> AUD exchange rate</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="geocoding-in-r.html"><a href="geocoding-in-r.html"><i class="fa fa-check"></i><b>12</b> Geocoding in R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="geocoding-in-r.html"><a href="geocoding-in-r.html#about-geocoding"><i class="fa fa-check"></i><b>12.1</b> About geocoding</a></li>
<li class="chapter" data-level="12.2" data-path="geocoding-in-r.html"><a href="geocoding-in-r.html#introducing-the-dataset"><i class="fa fa-check"></i><b>12.2</b> Introducing the dataset</a></li>
<li class="chapter" data-level="12.3" data-path="geocoding-in-r.html"><a href="geocoding-in-r.html#data-cleaning"><i class="fa fa-check"></i><b>12.3</b> Data cleaning</a></li>
<li class="chapter" data-level="12.4" data-path="geocoding-in-r.html"><a href="geocoding-in-r.html#running-the-geocode"><i class="fa fa-check"></i><b>12.4</b> Running the geocode</a></li>
<li class="chapter" data-level="12.5" data-path="geocoding-in-r.html"><a href="geocoding-in-r.html#from-geocode-to-shapefile"><i class="fa fa-check"></i><b>12.5</b> From geocode to shapefile</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="drive-time-analysis.html"><a href="drive-time-analysis.html"><i class="fa fa-check"></i><b>13</b> Drive time analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="drive-time-analysis.html"><a href="drive-time-analysis.html#background-on-drive-times"><i class="fa fa-check"></i><b>13.1</b> Background on drive times</a></li>
<li class="chapter" data-level="13.2" data-path="drive-time-analysis.html"><a href="drive-time-analysis.html#method-1-osrm-package"><i class="fa fa-check"></i><b>13.2</b> Method 1: OSRM package</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://https://www.linkedin.com/in/charlescoverdale/" target="blank">Connect with me on linkedin</a></li>
<li><a href="https://github.com/charlescoverdale/casualdabbler" target="blank">Get the code on github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R cookbook for the casual dabbler</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hypothesis-testing" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Hypothesis testing<a href="hypothesis-testing.html#hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="a-quick-refresher" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> A quick refresher<a href="hypothesis-testing.html#a-quick-refresher" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hypothesis testing is a way of validating if a claim about a population (e.g. a data set) is correct. Getting data on a whole population (e.g. everyone in Australia) is hard - so to validate a hypothesis, we use random samples from a population instead.</p>
<p>The language when dealing with hypothesis testing is purposefully janky.</p>
<p>When looking at the outputs of our hypothesis test, we consider p-values. Note: There’s <a href="https://towardsdatascience.com/the-problem-with-p-values-f056245f78a3"><strong><em>lots wrong with p-values</em></strong></a> that we won’t bother getting into right now. The long story short is if you make your null hypothesis ultra specific and only report when your p-value on your millionth iteration of a test is below 0.05… bad science is likely to get published and cited.</p>
<p>What we need to know:</p>
<ul>
<li><p>A small p-value (typically &lt; 0.05) indicates strong evidence <strong><em>against</em></strong> the null hypothesis, so we <strong><em>reject</em></strong> it.</p></li>
<li><p>A large p-value (&gt; 0.05) indicates weak evidence <strong><em>against</em></strong> the null hypothesis, so you <strong><em>fail to reject</em></strong> it.</p></li>
</ul>
<p>Let’s load in some packages and get started.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="hypothesis-testing.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in packages</span></span>
<span id="cb81-2"><a href="hypothesis-testing.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb81-3"><a href="hypothesis-testing.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb81-4"><a href="hypothesis-testing.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb81-5"><a href="hypothesis-testing.html#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb81-6"><a href="hypothesis-testing.html#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb81-7"><a href="hypothesis-testing.html#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb81-8"><a href="hypothesis-testing.html#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb81-9"><a href="hypothesis-testing.html#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb81-10"><a href="hypothesis-testing.html#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb81-11"><a href="hypothesis-testing.html#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb81-12"><a href="hypothesis-testing.html#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb81-13"><a href="hypothesis-testing.html#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb81-14"><a href="hypothesis-testing.html#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb81-15"><a href="hypothesis-testing.html#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalt)</span>
<span id="cb81-16"><a href="hypothesis-testing.html#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb81-17"><a href="hypothesis-testing.html#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb81-18"><a href="hypothesis-testing.html#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb81-19"><a href="hypothesis-testing.html#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aTSA)</span>
<span id="cb81-20"><a href="hypothesis-testing.html#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readrba)</span></code></pre></div>
</div>
<div id="t-testing-our-first-hypothesis" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> T-testing our first hypothesis<a href="hypothesis-testing.html#t-testing-our-first-hypothesis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ll start simple. Let’s create a random dataset - with the caveat that it will be normally distributed. By default the <code>rnorm</code> function will generate a dataset that has a mean of 0 and a standard deviation of 1.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="hypothesis-testing.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">40</span>)</span>
<span id="cb82-2"><a href="hypothesis-testing.html#cb82-2" aria-hidden="true" tabindex="-1"></a>dataset1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable1=</span><span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>))</span>
<span id="cb82-3"><a href="hypothesis-testing.html#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="hypothesis-testing.html#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb82-5"><a href="hypothesis-testing.html#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>dataset1<span class="sc">$</span>variable1,<span class="at">y=</span>..density..),<span class="at">binwidth=</span><span class="fl">0.1</span>,<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb82-6"><a href="hypothesis-testing.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb82-7"><a href="hypothesis-testing.html#cb82-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dataset1<span class="sc">$</span>variable1), <span class="at">sd =</span> <span class="fu">sd</span>(dataset1<span class="sc">$</span>variable1)))<span class="sc">+</span></span>
<span id="cb82-8"><a href="hypothesis-testing.html#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb82-9"><a href="hypothesis-testing.html#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb82-10"><a href="hypothesis-testing.html#cb82-10" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb82-11"><a href="hypothesis-testing.html#cb82-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Histogram for t-testing&quot;</span>,</span>
<span id="cb82-12"><a href="hypothesis-testing.html#cb82-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">caption =</span> <span class="st">&quot;Data: Made from rnorm(1000)&quot;</span>,</span>
<span id="cb82-13"><a href="hypothesis-testing.html#cb82-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb82-14"><a href="hypothesis-testing.html#cb82-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb82-15"><a href="hypothesis-testing.html#cb82-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-16"><a href="hypothesis-testing.html#cb82-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb82-17"><a href="hypothesis-testing.html#cb82-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb82-18"><a href="hypothesis-testing.html#cb82-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb82-19"><a href="hypothesis-testing.html#cb82-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb82-20"><a href="hypothesis-testing.html#cb82-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>))<span class="sc">+</span></span>
<span id="cb82-21"><a href="hypothesis-testing.html#cb82-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-22"><a href="hypothesis-testing.html#cb82-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb82-23"><a href="hypothesis-testing.html#cb82-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-24"><a href="hypothesis-testing.html#cb82-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb82-25"><a href="hypothesis-testing.html#cb82-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb82-26"><a href="hypothesis-testing.html#cb82-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb82-27"><a href="hypothesis-testing.html#cb82-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-28"><a href="hypothesis-testing.html#cb82-28" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb82-29"><a href="hypothesis-testing.html#cb82-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb82-30"><a href="hypothesis-testing.html#cb82-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb82-31"><a href="hypothesis-testing.html#cb82-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-32"><a href="hypothesis-testing.html#cb82-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb82-33"><a href="hypothesis-testing.html#cb82-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb82-34"><a href="hypothesis-testing.html#cb82-34" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p>We know by default that the mean of dataset1 will be approximately zero… but let’s check anyway.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="hypothesis-testing.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the mean of dataset1</span></span>
<span id="cb83-2"><a href="hypothesis-testing.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dataset1<span class="sc">$</span>variable1)</span></code></pre></div>
<p>Great, now let’s run our first hypothesis test. We’ll use the <code>t.test</code> function. This is in the format of t.test(data, null_hypothesis).</p>
<p>So quite simply, we can test the null hypothesis that the mean for dataset1$variable1 is 5).</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="hypothesis-testing.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis test</span></span>
<span id="cb84-2"><a href="hypothesis-testing.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(dataset1<span class="sc">$</span>variable1, <span class="at">mu =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>We see the p-value here is tiny, meaning we reject the null hypothesis. That is to say, the mean for dataset1$variable1 is not 5.</p>
<p>Going further, let’s test the hypothesis that the mean is 0.01.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="hypothesis-testing.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis test</span></span>
<span id="cb85-2"><a href="hypothesis-testing.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(dataset1<span class="sc">$</span>variable1, <span class="at">mu =</span> <span class="sc">-</span><span class="fl">0.03</span>, <span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<p>We see here the p-value is greater than 0.05, leading us to <strong><em>fail to reject</em></strong> the null hypothesis. In a sentence, we cannot say that the mean of dataset1$variable1 is different to 0.01.</p>
</div>
<div id="tailed-tests" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Tailed tests<a href="hypothesis-testing.html#tailed-tests" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous level we were cheating slightly, in that we didn’t specify the ‘tail’ for the test, or our confidence level. By default the t.test function assumes tests are two tailed, and the desired confidence level is 0.95 (i.e. 95%). However, in some cases we might want to have a hypothesis that says one variable is greater than or less than another variable (rather than just different from each other). This is where we use tails.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="hypothesis-testing.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis test</span></span>
<span id="cb86-2"><a href="hypothesis-testing.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(dataset1<span class="sc">$</span>variable1, <span class="at">mu =</span> <span class="fl">0.03</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
</div>
<div id="correlation-and-working-with-normal-distributions" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Correlation (and working with normal distributions)<a href="hypothesis-testing.html#correlation-and-working-with-normal-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A correlation coefficient measures the direction and strength of the correlation between two variables.</p>
<p>The tricky thing is - if variables aren’t normally distributed, none of our correlation theory works very well.</p>
<p>In the example below, we see that miles per gallon is correlated with horsepower. It’s a negative relationship, meaning the more horsepower in a car, the less miles per gallon the car exhibits.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="hypothesis-testing.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span></span>
<span id="cb87-2"><a href="hypothesis-testing.html#cb87-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb87-3"><a href="hypothesis-testing.html#cb87-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg),<span class="at">method=</span><span class="st">&#39;lm&#39;</span>)<span class="sc">+</span></span>
<span id="cb87-4"><a href="hypothesis-testing.html#cb87-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Building a regression model&quot;</span>,</span>
<span id="cb87-5"><a href="hypothesis-testing.html#cb87-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">&quot;Higher horsepower cars get less miles to the gallon&quot;</span>,</span>
<span id="cb87-6"><a href="hypothesis-testing.html#cb87-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Data: mtcars dataset&quot;</span>,</span>
<span id="cb87-7"><a href="hypothesis-testing.html#cb87-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="st">&quot;Horsepower&quot;</span>,</span>
<span id="cb87-8"><a href="hypothesis-testing.html#cb87-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span><span class="st">&quot;Miles per gallon&quot;</span>) <span class="sc">+</span> </span>
<span id="cb87-9"><a href="hypothesis-testing.html#cb87-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb87-10"><a href="hypothesis-testing.html#cb87-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb87-11"><a href="hypothesis-testing.html#cb87-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb87-12"><a href="hypothesis-testing.html#cb87-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb87-13"><a href="hypothesis-testing.html#cb87-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb87-14"><a href="hypothesis-testing.html#cb87-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb87-15"><a href="hypothesis-testing.html#cb87-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb87-16"><a href="hypothesis-testing.html#cb87-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb87-17"><a href="hypothesis-testing.html#cb87-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title.y =</span> </span>
<span id="cb87-18"><a href="hypothesis-testing.html#cb87-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">element_text</span>(<span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb87-19"><a href="hypothesis-testing.html#cb87-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb87-20"><a href="hypothesis-testing.html#cb87-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="sc">-</span><span class="dv">10</span>)))<span class="sc">+</span></span>
<span id="cb87-21"><a href="hypothesis-testing.html#cb87-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb87-22"><a href="hypothesis-testing.html#cb87-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.line.x =</span> </span>
<span id="cb87-23"><a href="hypothesis-testing.html#cb87-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">element_line</span>(<span class="at">colour =</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.4</span>))<span class="sc">+</span></span>
<span id="cb87-24"><a href="hypothesis-testing.html#cb87-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.4</span>))<span class="sc">+</span></span>
<span id="cb87-25"><a href="hypothesis-testing.html#cb87-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb87-26"><a href="hypothesis-testing.html#cb87-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb87-27"><a href="hypothesis-testing.html#cb87-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb87-28"><a href="hypothesis-testing.html#cb87-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb87-29"><a href="hypothesis-testing.html#cb87-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb87-30"><a href="hypothesis-testing.html#cb87-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb87-31"><a href="hypothesis-testing.html#cb87-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb87-32"><a href="hypothesis-testing.html#cb87-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb87-33"><a href="hypothesis-testing.html#cb87-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title.y =</span> </span>
<span id="cb87-34"><a href="hypothesis-testing.html#cb87-34" aria-hidden="true" tabindex="-1"></a>            <span class="fu">element_text</span>(<span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb87-35"><a href="hypothesis-testing.html#cb87-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb87-36"><a href="hypothesis-testing.html#cb87-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="sc">-</span><span class="dv">10</span>)))<span class="sc">+</span></span>
<span id="cb87-37"><a href="hypothesis-testing.html#cb87-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb87-38"><a href="hypothesis-testing.html#cb87-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.line.x =</span> </span>
<span id="cb87-39"><a href="hypothesis-testing.html#cb87-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">element_line</span>(<span class="at">colour =</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.4</span>))<span class="sc">+</span></span>
<span id="cb87-40"><a href="hypothesis-testing.html#cb87-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-41"><a href="hypothesis-testing.html#cb87-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.4</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<p>We can use the <code>cor.test</code> to tell us the correlation coefficient and the p-value of the correlation.</p>
<p>We specify the method as ‘pearson’ for the Pearson correlation coefficient. But we remember this method only works well if both our variables are normally distributed.</p>
<p>That’s worth checking - let’s plot a histogram for both hp and mpg.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="hypothesis-testing.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(mtcars<span class="sc">$</span>hp, mtcars<span class="sc">$</span>mpg, <span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="hypothesis-testing.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb89-2"><a href="hypothesis-testing.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>mtcars<span class="sc">$</span>mpg,<span class="at">y=</span>..density..),<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb89-3"><a href="hypothesis-testing.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb89-4"><a href="hypothesis-testing.html#cb89-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg), <span class="at">sd =</span> <span class="fu">sd</span>(mtcars<span class="sc">$</span>mpg)))<span class="sc">+</span></span>
<span id="cb89-5"><a href="hypothesis-testing.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb89-6"><a href="hypothesis-testing.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg), <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb89-7"><a href="hypothesis-testing.html#cb89-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Histogram of mtcars$mpg&quot;</span>,</span>
<span id="cb89-8"><a href="hypothesis-testing.html#cb89-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">caption =</span> <span class="st">&quot;Data: Made from mtcars&quot;</span>,</span>
<span id="cb89-9"><a href="hypothesis-testing.html#cb89-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb89-10"><a href="hypothesis-testing.html#cb89-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb89-11"><a href="hypothesis-testing.html#cb89-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb89-12"><a href="hypothesis-testing.html#cb89-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>))<span class="sc">+</span></span>
<span id="cb89-13"><a href="hypothesis-testing.html#cb89-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb89-14"><a href="hypothesis-testing.html#cb89-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb89-15"><a href="hypothesis-testing.html#cb89-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb89-16"><a href="hypothesis-testing.html#cb89-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb89-17"><a href="hypothesis-testing.html#cb89-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb89-18"><a href="hypothesis-testing.html#cb89-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb89-19"><a href="hypothesis-testing.html#cb89-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb89-20"><a href="hypothesis-testing.html#cb89-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb89-21"><a href="hypothesis-testing.html#cb89-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="hypothesis-testing.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb90-2"><a href="hypothesis-testing.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>mtcars<span class="sc">$</span>hp,<span class="at">y=</span>..density..),<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb90-3"><a href="hypothesis-testing.html#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb90-4"><a href="hypothesis-testing.html#cb90-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>hp), <span class="at">sd =</span> <span class="fu">sd</span>(mtcars<span class="sc">$</span>hp)))<span class="sc">+</span></span>
<span id="cb90-5"><a href="hypothesis-testing.html#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb90-6"><a href="hypothesis-testing.html#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>hp), <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb90-7"><a href="hypothesis-testing.html#cb90-7" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb90-8"><a href="hypothesis-testing.html#cb90-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Histogram of mtcars$hp&quot;</span>,</span>
<span id="cb90-9"><a href="hypothesis-testing.html#cb90-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">caption =</span> <span class="st">&quot;Data: Made from mtcars&quot;</span>,</span>
<span id="cb90-10"><a href="hypothesis-testing.html#cb90-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb90-11"><a href="hypothesis-testing.html#cb90-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb90-12"><a href="hypothesis-testing.html#cb90-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-13"><a href="hypothesis-testing.html#cb90-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb90-14"><a href="hypothesis-testing.html#cb90-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>))<span class="sc">+</span></span>
<span id="cb90-15"><a href="hypothesis-testing.html#cb90-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb90-16"><a href="hypothesis-testing.html#cb90-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb90-17"><a href="hypothesis-testing.html#cb90-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb90-18"><a href="hypothesis-testing.html#cb90-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb90-19"><a href="hypothesis-testing.html#cb90-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb90-20"><a href="hypothesis-testing.html#cb90-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb90-21"><a href="hypothesis-testing.html#cb90-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb90-22"><a href="hypothesis-testing.html#cb90-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb90-23"><a href="hypothesis-testing.html#cb90-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p>Crikey… they don’t look very normal at all.</p>
<p>Let’s plot QQ plots of our variables and see what’s going on.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="hypothesis-testing.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">sample =</span> mpg)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="hypothesis-testing.html#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>()<span class="sc">+</span></span>
<span id="cb91-3"><a href="hypothesis-testing.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()<span class="sc">+</span></span>
<span id="cb91-4"><a href="hypothesis-testing.html#cb91-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;QQ plot of mtcars$mpg&quot;</span>,</span>
<span id="cb91-5"><a href="hypothesis-testing.html#cb91-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">caption =</span> <span class="st">&quot;Data: Made from mtcars&quot;</span>,</span>
<span id="cb91-6"><a href="hypothesis-testing.html#cb91-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb91-7"><a href="hypothesis-testing.html#cb91-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb91-8"><a href="hypothesis-testing.html#cb91-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb91-9"><a href="hypothesis-testing.html#cb91-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>))<span class="sc">+</span></span>
<span id="cb91-10"><a href="hypothesis-testing.html#cb91-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb91-11"><a href="hypothesis-testing.html#cb91-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb91-12"><a href="hypothesis-testing.html#cb91-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb91-13"><a href="hypothesis-testing.html#cb91-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb91-14"><a href="hypothesis-testing.html#cb91-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb91-15"><a href="hypothesis-testing.html#cb91-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb91-16"><a href="hypothesis-testing.html#cb91-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb91-17"><a href="hypothesis-testing.html#cb91-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb91-18"><a href="hypothesis-testing.html#cb91-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="hypothesis-testing.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">sample =</span> hp)) <span class="sc">+</span></span>
<span id="cb92-2"><a href="hypothesis-testing.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>()<span class="sc">+</span></span>
<span id="cb92-3"><a href="hypothesis-testing.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()<span class="sc">+</span></span>
<span id="cb92-4"><a href="hypothesis-testing.html#cb92-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;QQ plot of mtcars$hp&quot;</span>,</span>
<span id="cb92-5"><a href="hypothesis-testing.html#cb92-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">caption =</span> <span class="st">&quot;Data: Made from mtcars&quot;</span>,</span>
<span id="cb92-6"><a href="hypothesis-testing.html#cb92-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb92-7"><a href="hypothesis-testing.html#cb92-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb92-8"><a href="hypothesis-testing.html#cb92-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb92-9"><a href="hypothesis-testing.html#cb92-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>))<span class="sc">+</span></span>
<span id="cb92-10"><a href="hypothesis-testing.html#cb92-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb92-11"><a href="hypothesis-testing.html#cb92-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb92-12"><a href="hypothesis-testing.html#cb92-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb92-13"><a href="hypothesis-testing.html#cb92-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb92-14"><a href="hypothesis-testing.html#cb92-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb92-15"><a href="hypothesis-testing.html#cb92-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb92-16"><a href="hypothesis-testing.html#cb92-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb92-17"><a href="hypothesis-testing.html#cb92-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb92-18"><a href="hypothesis-testing.html#cb92-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-77-2.png" width="672" /></p>
<p>Hmm okay, both series are a bit all over the shop.</p>
<p>Let’s do a statistical test to confirm.</p>
<p>The <strong>Shapiro-Wilk’s method</strong> is widely used for normality testing. The null hypothesis of this tests is that the sample distribution is normal. If the test is <strong>significant</strong>, the distribution is non-normal.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="hypothesis-testing.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb93-2"><a href="hypothesis-testing.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(mtcars<span class="sc">$</span>hp)</span></code></pre></div>
</div>
<div id="confidence-intervals-mean" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Confidence intervals (mean)<a href="hypothesis-testing.html#confidence-intervals-mean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Firstly, we can calculate the confidence interval on a single variable. Essentially this measures the variance of the normal distribution, and gives us an idea of how ‘clustered’ the values are to the mean.</p>
<p>There are roughly 4 steps to do this:</p>
<ol style="list-style-type: decimal">
<li><p>Calculate the mean</p></li>
<li><p>Calculate the standard error of the mean</p></li>
<li><p>Find the t-score that corresponds to the confidence level</p></li>
<li><p>Calculate the margin of error and construct the confidence interval</p></li>
</ol>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="hypothesis-testing.html#cb94-1" aria-hidden="true" tabindex="-1"></a>mpg.mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb94-2"><a href="hypothesis-testing.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mpg.mean)</span>
<span id="cb94-3"><a href="hypothesis-testing.html#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="hypothesis-testing.html#cb94-4" aria-hidden="true" tabindex="-1"></a>mpg.n <span class="ot">&lt;-</span> <span class="fu">length</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb94-5"><a href="hypothesis-testing.html#cb94-5" aria-hidden="true" tabindex="-1"></a>mpg.sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb94-6"><a href="hypothesis-testing.html#cb94-6" aria-hidden="true" tabindex="-1"></a>mpg.se <span class="ot">&lt;-</span> mpg.sd<span class="sc">/</span><span class="fu">sqrt</span>(mpg.n)</span>
<span id="cb94-7"><a href="hypothesis-testing.html#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mpg.se)</span>
<span id="cb94-8"><a href="hypothesis-testing.html#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="hypothesis-testing.html#cb94-9" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb94-10"><a href="hypothesis-testing.html#cb94-10" aria-hidden="true" tabindex="-1"></a>degrees.freedom <span class="ot">=</span> mpg.n <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb94-11"><a href="hypothesis-testing.html#cb94-11" aria-hidden="true" tabindex="-1"></a>t.score <span class="ot">=</span> <span class="fu">qt</span>(<span class="at">p=</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>degrees.freedom,<span class="at">lower.tail=</span>F)</span>
<span id="cb94-12"><a href="hypothesis-testing.html#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t.score)</span>
<span id="cb94-13"><a href="hypothesis-testing.html#cb94-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-14"><a href="hypothesis-testing.html#cb94-14" aria-hidden="true" tabindex="-1"></a>mpg.error <span class="ot">&lt;-</span> t.score <span class="sc">*</span> mpg.se</span>
<span id="cb94-15"><a href="hypothesis-testing.html#cb94-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-16"><a href="hypothesis-testing.html#cb94-16" aria-hidden="true" tabindex="-1"></a>lower.bound <span class="ot">&lt;-</span> mpg.mean <span class="sc">-</span> mpg.error</span>
<span id="cb94-17"><a href="hypothesis-testing.html#cb94-17" aria-hidden="true" tabindex="-1"></a>upper.bound <span class="ot">&lt;-</span> mpg.mean <span class="sc">+</span> mpg.error</span>
<span id="cb94-18"><a href="hypothesis-testing.html#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(lower.bound,upper.bound))</span></code></pre></div>
<p>For the lazy folks among us - there’s also this quick and dirty way of doing it.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="hypothesis-testing.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean and standard error</span></span>
<span id="cb95-2"><a href="hypothesis-testing.html#cb95-2" aria-hidden="true" tabindex="-1"></a>mpg.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="dv">1</span>, mtcars)</span>
<span id="cb95-3"><a href="hypothesis-testing.html#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="hypothesis-testing.html#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confidence interval</span></span>
<span id="cb95-5"><a href="hypothesis-testing.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mpg.model, <span class="at">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<p>Great. Let’s plot this interval on the distribution.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="hypothesis-testing.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb96-2"><a href="hypothesis-testing.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>mtcars<span class="sc">$</span>mpg,<span class="at">y=</span>..density..),<span class="at">binwidth=</span><span class="dv">2</span>,<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb96-3"><a href="hypothesis-testing.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb96-4"><a href="hypothesis-testing.html#cb96-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg), <span class="at">sd =</span> <span class="fu">sd</span>(mtcars<span class="sc">$</span>mpg)))<span class="sc">+</span></span>
<span id="cb96-5"><a href="hypothesis-testing.html#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb96-6"><a href="hypothesis-testing.html#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg), <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb96-7"><a href="hypothesis-testing.html#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> lower.bound,<span class="at">col=</span><span class="st">&quot;purple&quot;</span>)<span class="sc">+</span></span>
<span id="cb96-8"><a href="hypothesis-testing.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> upper.bound, <span class="at">col=</span><span class="st">&quot;purple&quot;</span>)<span class="sc">+</span></span>
<span id="cb96-9"><a href="hypothesis-testing.html#cb96-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Histogram of mtcars$mpg&quot;</span>,</span>
<span id="cb96-10"><a href="hypothesis-testing.html#cb96-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">caption =</span> <span class="st">&quot;Data: Made from mtcars&quot;</span>,</span>
<span id="cb96-11"><a href="hypothesis-testing.html#cb96-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb96-12"><a href="hypothesis-testing.html#cb96-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb96-13"><a href="hypothesis-testing.html#cb96-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb96-14"><a href="hypothesis-testing.html#cb96-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>))<span class="sc">+</span></span>
<span id="cb96-15"><a href="hypothesis-testing.html#cb96-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb96-16"><a href="hypothesis-testing.html#cb96-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb96-17"><a href="hypothesis-testing.html#cb96-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb96-18"><a href="hypothesis-testing.html#cb96-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb96-19"><a href="hypothesis-testing.html#cb96-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb96-20"><a href="hypothesis-testing.html#cb96-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb96-21"><a href="hypothesis-testing.html#cb96-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb96-22"><a href="hypothesis-testing.html#cb96-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb96-23"><a href="hypothesis-testing.html#cb96-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>Two things we note here: First, the distribution doesn’t look <strong><em>that</em></strong> normal. Second, geez that 95% confidence interval looks narrow as a result.</p>
<p>Let’s do the same analysis with an actual normal distribution and see what happens.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="hypothesis-testing.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">404</span>)</span>
<span id="cb97-2"><a href="hypothesis-testing.html#cb97-2" aria-hidden="true" tabindex="-1"></a>dataset2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable1=</span><span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>))</span>
<span id="cb97-3"><a href="hypothesis-testing.html#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="hypothesis-testing.html#cb97-4" aria-hidden="true" tabindex="-1"></a>df2.mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(dataset2<span class="sc">$</span>variable1)</span>
<span id="cb97-5"><a href="hypothesis-testing.html#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df2.mean)</span>
<span id="cb97-6"><a href="hypothesis-testing.html#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="hypothesis-testing.html#cb97-7" aria-hidden="true" tabindex="-1"></a>df2.n <span class="ot">&lt;-</span> <span class="fu">length</span>(dataset2<span class="sc">$</span>variable1)</span>
<span id="cb97-8"><a href="hypothesis-testing.html#cb97-8" aria-hidden="true" tabindex="-1"></a>df2.sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(dataset2<span class="sc">$</span>variable1)</span>
<span id="cb97-9"><a href="hypothesis-testing.html#cb97-9" aria-hidden="true" tabindex="-1"></a>df2.se <span class="ot">&lt;-</span> mpg.sd<span class="sc">/</span><span class="fu">sqrt</span>(mpg.n)</span>
<span id="cb97-10"><a href="hypothesis-testing.html#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df2.se)</span>
<span id="cb97-11"><a href="hypothesis-testing.html#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="hypothesis-testing.html#cb97-12" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb97-13"><a href="hypothesis-testing.html#cb97-13" aria-hidden="true" tabindex="-1"></a>degrees.freedom <span class="ot">=</span> df2.n <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb97-14"><a href="hypothesis-testing.html#cb97-14" aria-hidden="true" tabindex="-1"></a>t.score <span class="ot">=</span> <span class="fu">qt</span>(<span class="at">p=</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>degrees.freedom,<span class="at">lower.tail=</span>F)</span>
<span id="cb97-15"><a href="hypothesis-testing.html#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t.score)</span>
<span id="cb97-16"><a href="hypothesis-testing.html#cb97-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-17"><a href="hypothesis-testing.html#cb97-17" aria-hidden="true" tabindex="-1"></a>df2.error <span class="ot">&lt;-</span> t.score <span class="sc">*</span> df2.se</span>
<span id="cb97-18"><a href="hypothesis-testing.html#cb97-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-19"><a href="hypothesis-testing.html#cb97-19" aria-hidden="true" tabindex="-1"></a>lower.bound.df2 <span class="ot">&lt;-</span> df2.mean <span class="sc">-</span> df2.error</span>
<span id="cb97-20"><a href="hypothesis-testing.html#cb97-20" aria-hidden="true" tabindex="-1"></a>upper.bound.df2 <span class="ot">&lt;-</span> df2.mean <span class="sc">+</span> df2.error</span>
<span id="cb97-21"><a href="hypothesis-testing.html#cb97-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(lower.bound.df2,upper.bound.df2))</span>
<span id="cb97-22"><a href="hypothesis-testing.html#cb97-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-23"><a href="hypothesis-testing.html#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Make a function to colour the tails</span></span>
<span id="cb97-24"><a href="hypothesis-testing.html#cb97-24" aria-hidden="true" tabindex="-1"></a>upper_tail <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb97-25"><a href="hypothesis-testing.html#cb97-25" aria-hidden="true" tabindex="-1"></a>              y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb97-26"><a href="hypothesis-testing.html#cb97-26" aria-hidden="true" tabindex="-1"></a>              y[x <span class="sc">&lt;</span> upper.bound.df2  <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">1000</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb97-27"><a href="hypothesis-testing.html#cb97-27" aria-hidden="true" tabindex="-1"></a>              <span class="fu">return</span>(y) }</span>
<span id="cb97-28"><a href="hypothesis-testing.html#cb97-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-29"><a href="hypothesis-testing.html#cb97-29" aria-hidden="true" tabindex="-1"></a>lower_tail <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb97-30"><a href="hypothesis-testing.html#cb97-30" aria-hidden="true" tabindex="-1"></a>              y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb97-31"><a href="hypothesis-testing.html#cb97-31" aria-hidden="true" tabindex="-1"></a>              y[x <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1000</span>  <span class="sc">|</span> x <span class="sc">&gt;</span> lower.bound.df2] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb97-32"><a href="hypothesis-testing.html#cb97-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">return</span>(y) }</span>
<span id="cb97-33"><a href="hypothesis-testing.html#cb97-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-34"><a href="hypothesis-testing.html#cb97-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the distributions</span></span>
<span id="cb97-35"><a href="hypothesis-testing.html#cb97-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb97-36"><a href="hypothesis-testing.html#cb97-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>dataset2<span class="sc">$</span>variable1,<span class="at">y=</span>..density..),<span class="at">binwidth=</span><span class="fl">0.1</span>,<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb97-37"><a href="hypothesis-testing.html#cb97-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb97-38"><a href="hypothesis-testing.html#cb97-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dataset2<span class="sc">$</span>variable1), <span class="at">sd =</span> <span class="fu">sd</span>(dataset2<span class="sc">$</span>variable1)))<span class="sc">+</span></span>
<span id="cb97-39"><a href="hypothesis-testing.html#cb97-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb97-40"><a href="hypothesis-testing.html#cb97-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(dataset2<span class="sc">$</span>variable1), <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb97-41"><a href="hypothesis-testing.html#cb97-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> lower.bound.df2,<span class="at">col=</span><span class="st">&quot;purple&quot;</span>)<span class="sc">+</span></span>
<span id="cb97-42"><a href="hypothesis-testing.html#cb97-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> upper.bound.df2, <span class="at">col=</span><span class="st">&quot;purple&quot;</span>)<span class="sc">+</span></span>
<span id="cb97-43"><a href="hypothesis-testing.html#cb97-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> upper_tail, <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb97-44"><a href="hypothesis-testing.html#cb97-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> lower_tail, <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb97-45"><a href="hypothesis-testing.html#cb97-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb97-46"><a href="hypothesis-testing.html#cb97-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;95% confidence interval&quot;</span>,</span>
<span id="cb97-47"><a href="hypothesis-testing.html#cb97-47" aria-hidden="true" tabindex="-1"></a>                          <span class="at">caption =</span> <span class="st">&quot;Data: Made from rnorm(1000)&quot;</span>,</span>
<span id="cb97-48"><a href="hypothesis-testing.html#cb97-48" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb97-49"><a href="hypothesis-testing.html#cb97-49" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb97-50"><a href="hypothesis-testing.html#cb97-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-51"><a href="hypothesis-testing.html#cb97-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb97-52"><a href="hypothesis-testing.html#cb97-52" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb97-53"><a href="hypothesis-testing.html#cb97-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb97-54"><a href="hypothesis-testing.html#cb97-54" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb97-55"><a href="hypothesis-testing.html#cb97-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>))<span class="sc">+</span></span>
<span id="cb97-56"><a href="hypothesis-testing.html#cb97-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-57"><a href="hypothesis-testing.html#cb97-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb97-58"><a href="hypothesis-testing.html#cb97-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-59"><a href="hypothesis-testing.html#cb97-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb97-60"><a href="hypothesis-testing.html#cb97-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb97-61"><a href="hypothesis-testing.html#cb97-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb97-62"><a href="hypothesis-testing.html#cb97-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-63"><a href="hypothesis-testing.html#cb97-63" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb97-64"><a href="hypothesis-testing.html#cb97-64" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb97-65"><a href="hypothesis-testing.html#cb97-65" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb97-66"><a href="hypothesis-testing.html#cb97-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-67"><a href="hypothesis-testing.html#cb97-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb97-68"><a href="hypothesis-testing.html#cb97-68" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb97-69"><a href="hypothesis-testing.html#cb97-69" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p>Great - we’ve got a more sensible looking plot, and greyed out the tails where our confidence interval excludes. We expect out observation to fall somewhere between the two purple lines (or more exactly between -2.1 and 2.1)</p>
</div>
<div id="confidence-intervals-model" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Confidence intervals (model)<a href="hypothesis-testing.html#confidence-intervals-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Secondly, we can calculate the confidence internal around a linear model. Somewhat similar to above, this process shows us how confident we can be about any single point in the linear estimate (e.g. if it has an enormous confidence interval attached to it… the linear estimate of the value at that point is probably a bit dodgy).</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="hypothesis-testing.html#cb98-1" aria-hidden="true" tabindex="-1"></a>mtcars.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> mtcars)</span>
<span id="cb98-2"><a href="hypothesis-testing.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtcars.lm)</span>
<span id="cb98-3"><a href="hypothesis-testing.html#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="hypothesis-testing.html#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mtcars.lm, <span class="at">newdata =</span> mtcars, <span class="at">interval =</span> <span class="st">&#39;confidence&#39;</span>)</span></code></pre></div>
<p>It’s great to have the raw data - but there’s an even easier way of plotting the confidence interval on a chart: we use the <code>geom_smooth()</code>function.</p>
<p>The syntax in this example is:<br />
<code>geom_smooth(aes(x = hp, y = mpg), method='lm', level=0.95)</code></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="hypothesis-testing.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span></span>
<span id="cb99-2"><a href="hypothesis-testing.html#cb99-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb99-3"><a href="hypothesis-testing.html#cb99-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg),<span class="at">method=</span><span class="st">&#39;lm&#39;</span>,<span class="at">level=</span><span class="fl">0.95</span>)<span class="sc">+</span></span>
<span id="cb99-4"><a href="hypothesis-testing.html#cb99-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Building a regression model&quot;</span>,</span>
<span id="cb99-5"><a href="hypothesis-testing.html#cb99-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">&quot;Higher horsepower cars get less miles to the gallon&quot;</span>,</span>
<span id="cb99-6"><a href="hypothesis-testing.html#cb99-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Data: mtcars dataset&quot;</span>,</span>
<span id="cb99-7"><a href="hypothesis-testing.html#cb99-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="st">&quot;Horsepower&quot;</span>,</span>
<span id="cb99-8"><a href="hypothesis-testing.html#cb99-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span><span class="st">&quot;Miles per gallon&quot;</span>) <span class="sc">+</span> </span>
<span id="cb99-9"><a href="hypothesis-testing.html#cb99-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb99-10"><a href="hypothesis-testing.html#cb99-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb99-11"><a href="hypothesis-testing.html#cb99-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb99-12"><a href="hypothesis-testing.html#cb99-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb99-13"><a href="hypothesis-testing.html#cb99-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb99-14"><a href="hypothesis-testing.html#cb99-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb99-15"><a href="hypothesis-testing.html#cb99-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb99-16"><a href="hypothesis-testing.html#cb99-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb99-17"><a href="hypothesis-testing.html#cb99-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title.y =</span> </span>
<span id="cb99-18"><a href="hypothesis-testing.html#cb99-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">element_text</span>(<span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb99-19"><a href="hypothesis-testing.html#cb99-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb99-20"><a href="hypothesis-testing.html#cb99-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="sc">-</span><span class="dv">10</span>)))<span class="sc">+</span></span>
<span id="cb99-21"><a href="hypothesis-testing.html#cb99-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb99-22"><a href="hypothesis-testing.html#cb99-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.line.x =</span> </span>
<span id="cb99-23"><a href="hypothesis-testing.html#cb99-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">element_line</span>(<span class="at">colour =</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.4</span>))<span class="sc">+</span></span>
<span id="cb99-24"><a href="hypothesis-testing.html#cb99-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.4</span>))<span class="sc">+</span></span>
<span id="cb99-25"><a href="hypothesis-testing.html#cb99-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb99-26"><a href="hypothesis-testing.html#cb99-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb99-27"><a href="hypothesis-testing.html#cb99-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>,<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb99-28"><a href="hypothesis-testing.html#cb99-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb99-29"><a href="hypothesis-testing.html#cb99-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb99-30"><a href="hypothesis-testing.html#cb99-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb99-31"><a href="hypothesis-testing.html#cb99-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb99-32"><a href="hypothesis-testing.html#cb99-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb99-33"><a href="hypothesis-testing.html#cb99-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title.y =</span> </span>
<span id="cb99-34"><a href="hypothesis-testing.html#cb99-34" aria-hidden="true" tabindex="-1"></a>            <span class="fu">element_text</span>(<span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb99-35"><a href="hypothesis-testing.html#cb99-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb99-36"><a href="hypothesis-testing.html#cb99-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="sc">-</span><span class="dv">10</span>)))<span class="sc">+</span></span>
<span id="cb99-37"><a href="hypothesis-testing.html#cb99-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">margin=</span>ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb99-38"><a href="hypothesis-testing.html#cb99-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.line.x =</span> </span>
<span id="cb99-39"><a href="hypothesis-testing.html#cb99-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">element_line</span>(<span class="at">colour =</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.4</span>))<span class="sc">+</span></span>
<span id="cb99-40"><a href="hypothesis-testing.html#cb99-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-41"><a href="hypothesis-testing.html#cb99-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.4</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>For a sanity check, let’s crank up the confidence level to 0.999 (meaning our interval should capture just about all the observations). We see the confidence interval band increases… but not by <em>that</em> much. Why? Well remember how the data isn’t a very good normal distribution? That means the confidence interval function won’t be super accurate - especially at the extremes.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="charts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="forecasting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/charlescoverdale/casualdabbler/edit/master/08-Hypothesis-testing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
